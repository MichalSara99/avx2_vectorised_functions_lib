.model flat,c
.const
align 16
;; =================== packed single precision floating point for TAN,COT ====================

cephes_fopi_ps					real4	1.27323954473516,1.27323954473516
								real4   1.27323954473516,1.27323954473516
								real4   1.27323954473516,1.27323954473516
								real4   1.27323954473516,1.27323954473516

cephes_dp_ps					real4	-0.78515625,-0.78515625
								real4	-0.78515625,-0.78515625
								real4	-0.78515625,-0.78515625
								real4	-0.78515625,-0.78515625
								real4	-2.4187564849853515625e-4,-2.4187564849853515625e-4
								real4	-2.4187564849853515625e-4,-2.4187564849853515625e-4
								real4	-2.4187564849853515625e-4,-2.4187564849853515625e-4
								real4	-2.4187564849853515625e-4,-2.4187564849853515625e-4
								real4	-3.77489497744594108e-8,-3.77489497744594108e-8
								real4   -3.77489497744594108e-8,-3.77489497744594108e-8
								real4	-3.77489497744594108e-8,-3.77489497744594108e-8
								real4   -3.77489497744594108e-8,-3.77489497744594108e-8

tancof_ps						real4	9.38540185543e-3,9.38540185543e-3
								real4	9.38540185543e-3,9.38540185543e-3
								real4	9.38540185543e-3,9.38540185543e-3
								real4	9.38540185543e-3,9.38540185543e-3
								real4	3.11992232697e-3,3.11992232697e-3
								real4	3.11992232697e-3,3.11992232697e-3
								real4	3.11992232697e-3,3.11992232697e-3
								real4	3.11992232697e-3,3.11992232697e-3
								real4	2.44301354525e-2,2.44301354525e-2
								real4	2.44301354525e-2,2.44301354525e-2
								real4	2.44301354525e-2,2.44301354525e-2
								real4	2.44301354525e-2,2.44301354525e-2
								real4	5.34112807005e-2,5.34112807005e-2
								real4	5.34112807005e-2,5.34112807005e-2
								real4	5.34112807005e-2,5.34112807005e-2
								real4	5.34112807005e-2,5.34112807005e-2
								real4	1.33387994085e-1,1.33387994085e-1
								real4	1.33387994085e-1,1.33387994085e-1
								real4	1.33387994085e-1,1.33387994085e-1
								real4	1.33387994085e-1,1.33387994085e-1
								real4	3.33331568548e-1,3.33331568548e-1
								real4	3.33331568548e-1,3.33331568548e-1
								real4	3.33331568548e-1,3.33331568548e-1
								real4	3.33331568548e-1,3.33331568548e-1

one_ps							real4	1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0
;; =================== packed double precision floating point for TAN,COT ====================

cephes_fopi_pd					real8	1.273239544735162,1.273239544735162
								real8   1.273239544735162,1.273239544735162

c1_od16_pd						real8	0.0625,0.0625,0.0625,0.0625
c1_s16_pd						real8	16.0,16.0,16.0,16.0


cephes_dp_pd					real8	7.853981554508209228515625E-1,7.853981554508209228515625E-1
								real8	7.853981554508209228515625E-1,7.853981554508209228515625E-1
								real8	7.94662735614792836714E-9,7.94662735614792836714E-9
								real8	7.94662735614792836714E-9,7.94662735614792836714E-9
								real8	3.06161699786838294307E-17,3.06161699786838294307E-17
								real8   3.06161699786838294307E-17,3.06161699786838294307E-17

prec_pd							real8	1.0e-14,1.0e-14,1.0e-14,1.0e-14			

tancof_pd						real8	-1.30936939181383777646E+4,-1.30936939181383777646E+4
								real8	-1.30936939181383777646E+4,-1.30936939181383777646E+4
								real8	1.15351664838587416140E+6,1.15351664838587416140E+6
								real8	1.15351664838587416140E+6,1.15351664838587416140E+6
								real8	-1.79565251976484877988E+7,-1.79565251976484877988E+7
								real8	-1.79565251976484877988E+7,-1.79565251976484877988E+7
								
								real8	1.36812963470692954678E+4,1.36812963470692954678E+4
								real8	1.36812963470692954678E+4,1.36812963470692954678E+4
								real8	-1.32089234440210967447E+6,-1.32089234440210967447E+6
								real8	-1.32089234440210967447E+6,-1.32089234440210967447E+6
								real8	2.50083801823357915839E+7,2.50083801823357915839E+7
								real8	2.50083801823357915839E+7,2.50083801823357915839E+7
								real8	-5.38695755929454629881E+7,-5.38695755929454629881E+7
								real8	-5.38695755929454629881E+7,-5.38695755929454629881E+7

mone_pd							real8	-1.0,-1.0,-1.0,-1.0
one_pd							real8	1.0,1.0,1.0,1.0
;; ================================ GENERAL ===================================================

int_sign_mask_d					dword	80000000h,80000000h,80000000h,80000000h
								dword	80000000h,80000000h,80000000h,80000000h
int_sign_mask_q					qword	8000000000000000h,8000000000000000h
								qword	8000000000000000h,8000000000000000h
int_inv_sign_mask_d				dword	7fffffffh,7fffffffh,7fffffffh,7fffffffh
								dword	7fffffffh,7fffffffh,7fffffffh,7fffffffh
int_one_d						dword	1h,1h,1h,1h,1h,1h,1h,1h
int_inv_one_d					dword	-2,-2,-2,-2,-2,-2,-2,-2
int_two_d						dword	2h,2h,2h,2h,2h,2h,2h,2h
mask_0_d						dword	0h,0h,0h,0h
mask_1_d						dword	1h,1h,1h,1h
mask_2_d						dword	2h,2h,2h,2h


;; ================================ PROTOTYPES ================================================

tan_avx2_ps proto,
			x_ptr:ptr real4,
			n_arg:dword,
			out_ptr:ptr real4	
			
cot_avx2_ps proto,
			x_ptr:ptr real4,
			n_arg:dword,
			out_ptr:ptr real4	

tan_avx2_pd proto,
			x_ptr:ptr real8,
			n_arg:dword,
			out_ptr:ptr real8	
			
cot_avx2_pd proto,
			x_ptr:ptr real8,
			n_arg:dword,
			out_ptr:ptr real8